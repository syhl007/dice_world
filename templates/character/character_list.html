<head>
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/character/character_style.css' %}"/>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="/static/js/jquery-3.3.1.js" type="text/javascript"></script>
    <script>
        function link_character(button) {
            var character_id = $(button).attr('character_id');
            $.ajax({
                url: "{% url 'character:character_link' %}",
                type: 'post',
                data: {'character_id':character_id,'group_id':'{{ group_id }}','csrfmiddlewaretoken':'{{ csrf_token }}'},
                async: true,
                success: function (data) {
                    var obj = JSON.parse(data);
                    if(obj.state==0){
                        alert("关联成功");
                        window.history.back(-1);
                    }
                }
            })
        }
    </script>
</head>
<body>
{% if character_list %}
    <ul>
        {% for character in character_list %}
            <li>
                <div><img class="character_head" src=/{{ character.head.name }}></div>
                <a href="{%  url 'character:character_detail' character.id %}" target="_blank">{{ character.name }}</a>
                {% if group_id %}
                    <button character_id={{ character.id }} onclick="link_character(this)">关联</button>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p>No character are available.</p>
{% endif %}
</body>